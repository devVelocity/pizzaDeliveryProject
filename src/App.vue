<template>
  <!-- <teleport to="#navWrapper"> -->
  <div id="nav">
    <router-link to="/">
      <svg id="navLogo" viewBox="0 0 924 423" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g id="logo-full">
      <g id="Text">
      <path id="Company" d="M384.48 278C378.912 278 374.624 276.656 371.616 273.968C368.672 271.216 367.2 267.12 367.2 261.68V227.12C367.2 221.68 368.672 217.616 371.616 214.928C374.624 212.176 378.912 210.8 384.48 210.8H396.192V218.096H383.52C381.152 218.096 379.232 218.8 377.76 220.208C376.288 221.616 375.552 223.312 375.552 225.296V263.504C375.552 265.488 376.288 267.184 377.76 268.592C379.232 270 381.152 270.704 383.52 270.704H396.192V278H384.48ZM438.262 262.64C438.262 268.016 436.918 271.92 434.23 274.352C431.606 276.784 427.51 278 421.942 278H420.694C415.126 278 410.998 276.784 408.31 274.352C405.686 271.92 404.374 268.016 404.374 262.64V245.36C404.374 239.984 405.686 236.08 408.31 233.648C410.998 231.216 415.126 230 420.694 230H421.942C427.51 230 431.606 231.216 434.23 233.648C436.918 236.08 438.262 239.984 438.262 245.36V262.64ZM430.102 243.44C430.102 241.456 429.494 239.92 428.278 238.832C427.062 237.744 425.27 237.2 422.902 237.2H419.734C417.366 237.2 415.574 237.744 414.358 238.832C413.142 239.92 412.534 241.456 412.534 243.44V264.56C412.534 266.544 413.142 268.08 414.358 269.168C415.574 270.256 417.366 270.8 419.734 270.8H422.902C425.27 270.8 427.062 270.256 428.278 269.168C429.494 268.08 430.102 266.544 430.102 264.56V243.44ZM451.238 230H458.918V232.304C460.902 230.768 463.462 230 466.598 230H467.174C472.998 230 477.158 231.472 479.654 234.416C482.022 231.472 485.318 230 489.542 230H490.118C495.302 230 499.142 231.216 501.638 233.648C504.198 236.08 505.478 239.984 505.478 245.36V278H497.318V243.44C497.318 241.52 496.742 240.016 495.59 238.928C494.502 237.776 492.998 237.2 491.078 237.2H488.582C486.598 237.2 485.094 237.808 484.07 239.024C483.11 240.176 482.566 241.424 482.438 242.768V278H474.278V243.44C474.278 241.52 473.734 240.016 472.646 238.928C471.558 237.776 470.054 237.2 468.134 237.2H465.638C463.59 237.2 462.022 237.744 460.934 238.832C459.91 239.856 459.398 240.976 459.398 242.192V278H451.238V230ZM518.891 230H526.571V232.304C528.555 230.768 531.115 230 534.251 230H535.787C541.419 230 545.547 231.216 548.171 233.648C550.795 236.016 552.107 239.92 552.107 245.36V262.64C552.107 268.016 550.763 271.92 548.075 274.352C545.451 276.784 541.355 278 535.787 278H527.051V294.32H518.891V230ZM533.291 237.2C531.179 237.2 529.611 237.776 528.587 238.928C527.563 240.016 527.051 241.2 527.051 242.48V270.8H536.747C539.115 270.8 540.907 270.256 542.123 269.168C543.339 268.08 543.947 266.544 543.947 264.56V243.44C543.947 241.456 543.339 239.92 542.123 238.832C540.907 237.744 539.115 237.2 536.747 237.2H533.291ZM593.396 278C592.564 278 591.636 277.744 590.612 277.232C589.652 276.72 588.82 276.016 588.116 275.12C586.644 277.04 584.692 278 582.26 278H575.636C570.772 278 567.22 277.04 564.98 275.12C562.804 273.136 561.716 269.776 561.716 265.04V263.12C561.716 253.2 566.388 248.24 575.732 248.24H585.716V243.44C585.716 241.456 585.108 239.92 583.892 238.832C582.676 237.744 580.884 237.2 578.516 237.2H565.556V230H577.556C583.124 230 587.22 231.216 589.844 233.648C592.532 236.08 593.876 239.984 593.876 245.36V268.4C593.876 269.36 594.228 270.096 594.932 270.608C595.7 271.056 596.948 271.28 598.676 271.28V278H593.396ZM581.3 270.8C583.22 270.8 584.436 270.352 584.948 269.456C585.46 268.56 585.716 267.408 585.716 266V255.44H575.636C573.972 255.44 572.596 255.984 571.508 257.072C570.42 258.16 569.876 259.536 569.876 261.2V266C569.876 267.664 570.26 268.88 571.028 269.648C571.796 270.416 573.012 270.8 574.676 270.8H581.3ZM608.73 230H616.41V232.304C618.394 230.768 620.954 230 624.09 230H626.586C631.77 230 635.61 231.216 638.106 233.648C640.666 236.08 641.946 239.984 641.946 245.36V278H633.786V243.44C633.786 241.52 633.21 240.016 632.058 238.928C630.97 237.776 629.466 237.2 627.546 237.2H623.13C621.018 237.2 619.45 237.776 618.426 238.928C617.402 240.016 616.89 241.2 616.89 242.48V278H608.73V230ZM673.934 282.224C673.166 285.104 672.366 287.408 671.534 289.136C670.702 290.928 669.518 292.304 667.982 293.264C666.51 294.288 664.526 294.8 662.03 294.8C660.686 294.8 658.862 294.608 656.558 294.224V287.216C658.35 287.472 660.014 287.6 661.55 287.6C663.342 287.6 664.622 286.16 665.39 283.28L666.926 278H665.006L650.126 230H658.958L670.094 269.648L679.502 230H687.854L673.934 282.224Z" fill="white"/>
      <path id="Pizza" d="M401.856 157.72C401.856 162.904 400.48 166.744 397.728 169.24C394.976 171.672 390.912 172.888 385.536 172.888H376.512V199H368.16V131.8H385.344C390.784 131.8 394.88 133.016 397.632 135.448C400.448 137.816 401.856 141.592 401.856 146.776V157.72ZM393.504 145.912C393.504 143.48 392.928 141.72 391.776 140.632C390.688 139.544 388.928 139 386.496 139H376.512V165.688H386.496C388.928 165.688 390.688 165.144 391.776 164.056C392.928 162.904 393.504 161.112 393.504 158.68V145.912ZM412.916 140.44V131.8H422.036V140.44H412.916ZM413.396 199V151H421.556V199H413.396ZM440.96 191.896H460.736V199H432.128V191.32L452.96 158.104H434.048V151H461.696V159.544L440.96 191.896ZM478.238 191.896H498.014V199H469.406V191.32L490.238 158.104H471.326V151H498.974V159.544L478.238 191.896ZM538.365 199C537.533 199 536.605 198.744 535.581 198.232C534.621 197.72 533.789 197.016 533.085 196.12C531.613 198.04 529.661 199 527.229 199H520.605C515.741 199 512.189 198.04 509.949 196.12C507.773 194.136 506.685 190.776 506.685 186.04V184.12C506.685 174.2 511.357 169.24 520.701 169.24H530.685V164.44C530.685 162.456 530.077 160.92 528.861 159.832C527.645 158.744 525.853 158.2 523.485 158.2H510.525V151H522.525C528.093 151 532.189 152.216 534.813 154.648C537.501 157.08 538.845 160.984 538.845 166.36V189.4C538.845 190.36 539.197 191.096 539.901 191.608C540.669 192.056 541.917 192.28 543.645 192.28V199H538.365ZM526.269 191.8C528.189 191.8 529.405 191.352 529.917 190.456C530.429 189.56 530.685 188.408 530.685 187V176.44H520.605C518.941 176.44 517.565 176.984 516.477 178.072C515.389 179.16 514.845 180.536 514.845 182.2V187C514.845 188.664 515.229 189.88 515.997 190.648C516.765 191.416 517.981 191.8 519.645 191.8H526.269ZM384.48 278C378.912 278 374.624 276.656 371.616 273.968C368.672 271.216 367.2 267.12 367.2 261.68V227.12C367.2 221.68 368.672 217.616 371.616 214.928C374.624 212.176 378.912 210.8 384.48 210.8H396.192V218.096H383.52C381.152 218.096 379.232 218.8 377.76 220.208C376.288 221.616 375.552 223.312 375.552 225.296V263.504C375.552 265.488 376.288 267.184 377.76 268.592C379.232 270 381.152 270.704 383.52 270.704H396.192V278H384.48ZM438.262 262.64C438.262 268.016 436.918 271.92 434.23 274.352C431.606 276.784 427.51 278 421.942 278H420.694C415.126 278 410.998 276.784 408.31 274.352C405.686 271.92 404.374 268.016 404.374 262.64V245.36C404.374 239.984 405.686 236.08 408.31 233.648C410.998 231.216 415.126 230 420.694 230H421.942C427.51 230 431.606 231.216 434.23 233.648C436.918 236.08 438.262 239.984 438.262 245.36V262.64ZM430.102 243.44C430.102 241.456 429.494 239.92 428.278 238.832C427.062 237.744 425.27 237.2 422.902 237.2H419.734C417.366 237.2 415.574 237.744 414.358 238.832C413.142 239.92 412.534 241.456 412.534 243.44V264.56C412.534 266.544 413.142 268.08 414.358 269.168C415.574 270.256 417.366 270.8 419.734 270.8H422.902C425.27 270.8 427.062 270.256 428.278 269.168C429.494 268.08 430.102 266.544 430.102 264.56V243.44ZM451.238 230H458.918V232.304C460.902 230.768 463.462 230 466.598 230H467.174C472.998 230 477.158 231.472 479.654 234.416C482.022 231.472 485.318 230 489.542 230H490.118C495.302 230 499.142 231.216 501.638 233.648C504.198 236.08 505.478 239.984 505.478 245.36V278H497.318V243.44C497.318 241.52 496.742 240.016 495.59 238.928C494.502 237.776 492.998 237.2 491.078 237.2H488.582C486.598 237.2 485.094 237.808 484.07 239.024C483.11 240.176 482.566 241.424 482.438 242.768V278H474.278V243.44C474.278 241.52 473.734 240.016 472.646 238.928C471.558 237.776 470.054 237.2 468.134 237.2H465.638C463.59 237.2 462.022 237.744 460.934 238.832C459.91 239.856 459.398 240.976 459.398 242.192V278H451.238V230ZM518.891 230H526.571V232.304C528.555 230.768 531.115 230 534.251 230H535.787C541.419 230 545.547 231.216 548.171 233.648C550.795 236.016 552.107 239.92 552.107 245.36V262.64C552.107 268.016 550.763 271.92 548.075 274.352C545.451 276.784 541.355 278 535.787 278H527.051V294.32H518.891V230ZM533.291 237.2C531.179 237.2 529.611 237.776 528.587 238.928C527.563 240.016 527.051 241.2 527.051 242.48V270.8H536.747C539.115 270.8 540.907 270.256 542.123 269.168C543.339 268.08 543.947 266.544 543.947 264.56V243.44C543.947 241.456 543.339 239.92 542.123 238.832C540.907 237.744 539.115 237.2 536.747 237.2H533.291ZM593.396 278C592.564 278 591.636 277.744 590.612 277.232C589.652 276.72 588.82 276.016 588.116 275.12C586.644 277.04 584.692 278 582.26 278H575.636C570.772 278 567.22 277.04 564.98 275.12C562.804 273.136 561.716 269.776 561.716 265.04V263.12C561.716 253.2 566.388 248.24 575.732 248.24H585.716V243.44C585.716 241.456 585.108 239.92 583.892 238.832C582.676 237.744 580.884 237.2 578.516 237.2H565.556V230H577.556C583.124 230 587.22 231.216 589.844 233.648C592.532 236.08 593.876 239.984 593.876 245.36V268.4C593.876 269.36 594.228 270.096 594.932 270.608C595.7 271.056 596.948 271.28 598.676 271.28V278H593.396ZM581.3 270.8C583.22 270.8 584.436 270.352 584.948 269.456C585.46 268.56 585.716 267.408 585.716 266V255.44H575.636C573.972 255.44 572.596 255.984 571.508 257.072C570.42 258.16 569.876 259.536 569.876 261.2V266C569.876 267.664 570.26 268.88 571.028 269.648C571.796 270.416 573.012 270.8 574.676 270.8H581.3ZM608.73 230H616.41V232.304C618.394 230.768 620.954 230 624.09 230H626.586C631.77 230 635.61 231.216 638.106 233.648C640.666 236.08 641.946 239.984 641.946 245.36V278H633.786V243.44C633.786 241.52 633.21 240.016 632.058 238.928C630.97 237.776 629.466 237.2 627.546 237.2H623.13C621.018 237.2 619.45 237.776 618.426 238.928C617.402 240.016 616.89 241.2 616.89 242.48V278H608.73V230ZM673.934 282.224C673.166 285.104 672.366 287.408 671.534 289.136C670.702 290.928 669.518 292.304 667.982 293.264C666.51 294.288 664.526 294.8 662.03 294.8C660.686 294.8 658.862 294.608 656.558 294.224V287.216C658.35 287.472 660.014 287.6 661.55 287.6C663.342 287.6 664.622 286.16 665.39 283.28L666.926 278H665.006L650.126 230H658.958L670.094 269.648L679.502 230H687.854L673.934 282.224Z" fill="white"/>
      <path id="The" d="M384.576 60.096V120H376.224V60.096H361.44V52.8H399.36V60.096H384.576ZM407.021 52.8H415.181V73.92C417.101 72.64 419.501 72 422.381 72H424.877C430.061 72 433.901 73.216 436.397 75.648C438.957 78.08 440.237 81.984 440.237 87.36V120H432.077V85.44C432.077 83.52 431.501 82.016 430.349 80.928C429.261 79.776 427.757 79.2 425.837 79.2H421.421C419.373 79.2 417.805 79.744 416.717 80.832C415.693 81.856 415.181 82.976 415.181 84.192V120H407.021V52.8ZM469.035 120C463.403 120 459.275 118.816 456.651 116.448C454.027 114.016 452.715 110.08 452.715 104.64V87.36C452.715 81.856 453.899 77.92 456.267 75.552C458.635 73.184 462.571 72 468.075 72H470.667C475.211 72 478.635 73.28 480.939 75.84C483.307 78.336 484.491 82.016 484.491 86.88V99.36H460.875V106.56C460.875 108.544 461.483 110.08 462.699 111.168C463.915 112.256 465.707 112.8 468.075 112.8H481.419V120H469.035ZM476.523 92.16V84.96C476.523 83.296 475.979 81.92 474.891 80.832C473.803 79.744 472.427 79.2 470.763 79.2H467.115C464.811 79.2 463.179 79.744 462.219 80.832C461.323 81.856 460.875 83.392 460.875 85.44V92.16H476.523Z" fill="white"/>
      </g>
      <g id="Pizza_2">
      <path id="Pizza-Shape" d="M302.952 269.473C313.203 291.544 291.318 314.846 268.648 305.998L36.0244 215.213C18.5377 208.389 13.1787 186.244 25.6103 172.18L150.465 30.9237C163.358 16.3369 186.982 19.7751 195.183 37.4318L302.952 269.473Z" fill="url(#paint0_linear)"/>
      <g id="Pepperoni3">
      <circle cx="124.5" cy="200.5" r="24.5" fill="#B31717"/>
      <circle cx="124.5" cy="200.5" r="24.5" fill="#B31717"/>
      <circle cx="124.5" cy="200.5" r="24.5" fill="#B31717"/>
      </g>
      <g id="Pepperoni2">
      <circle cx="189.5" cy="132.5" r="24.5" fill="#B31717"/>
      <circle cx="189.5" cy="132.5" r="24.5" fill="#B31717"/>
      <circle cx="189.5" cy="132.5" r="24.5" fill="#B31717"/>
      </g>
      <g id="Pepperoni1">
      <circle cx="225.5" cy="235.5" r="24.5" fill="#B31717"/>
      <circle cx="225.5" cy="235.5" r="24.5" fill="#B31717"/>
      <circle cx="225.5" cy="235.5" r="24.5" fill="#B31717"/>
      </g>
      </g>
      </g>
      <defs>
      <linearGradient id="paint0_linear" x1="339.024" y1="321.659" x2="88.8989" y2="100.577" gradientUnits="userSpaceOnUse">
      <stop stop-color="#C4C4C4"/>
      <stop offset="0.0001" stop-color="#EAAA4B" stop-opacity="0.984375"/>
      <stop offset="0.864583" stop-color="#CC9849"/>
      <stop offset="1" stop-color="#582A00"/>
      </linearGradient>
      </defs>
      </svg>
      <img aria-label="logo" id="navPizza" src="./assets/images/svg-elements/logo-pizza.svg">
    </router-link>
    <router-link aria-label="Home" class="nav-link" to="/">Home</router-link>
    <router-link aria-label="Our Menu" class="nav-link" to="/menu">Our Menu</router-link>
    <router-link aria-label="Basket" class="nav-link basketLink" to="/basket">Basket <span v-if="this.basketItems > 9">9+</span><span v-if="this.basketItems < 9">{{ basketItems }}</span></router-link>
    <a href="#" id="mobileNavToggle" v-on:click="handleMobile()">
      <span id="mobileNavOpen" v-if="!isMobileNavOpen">
        <svg aria-label="Mobile Navigation Button Open" width="50" height="80" viewBox="0 0 320 271" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="320" height="45" rx="26" fill="white"/>
        <rect y="100" width="320" height="45" rx="26" fill="white"/>
        <rect y="200" width="320" height="45" rx="26" fill="white"/>
        </svg>
      </span>
      <span id="mobileNavClose" v-if="isMobileNavOpen">
        <svg aria-label="Mobile Navigation Button Close" width="50" height="80" viewBox="0 0 259 259" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="31.8198" width="320" height="45" rx="22.5" transform="rotate(45 31.8198 0)" fill="white"/>
        <rect y="226.274" width="320" height="45" rx="22.5" transform="rotate(-45 0 226.274)" fill="white"/>
        </svg>
      </span>
    </a>
    <!-- <router-link aria-label="Basket" id="basketToggle" to="/basket">
      <svg width="80" height="60" viewBox="0 0 1027 819" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g id="Group 1">
      <path id="CartOutline" d="M816 612V436.69C816 416.488 800.573 399.63 780.45 397.843L230.484 349M816 612H692H391.617C377.1 612 363.784 603.936 357.057 591.071L230.484 349M816 612L791.632 688.795C786.492 704.995 771.454 716 754.459 716H368M230.484 349L167.169 235.944C160.272 223.628 147.258 216 133.142 216H0" stroke="black" stroke-width="28"/>
      <g id="Wheel2">
      <circle cx="378.5" cy="743.5" r="75.5" fill="black"/>
      <circle cx="378.5" cy="743.5" r="75.5" fill="black"/>
      <circle cx="378.5" cy="743.5" r="75.5" fill="black"/>
      </g>
      <g id="Wheel1">
      <circle cx="787.5" cy="743.5" r="75.5" fill="black"/>
      <circle cx="787.5" cy="743.5" r="75.5" fill="black"/>
      <circle cx="787.5" cy="743.5" r="75.5" fill="black"/>
      </g>
      <path id="CartMesh" d="M307 360L370 608M307 360L390 367.5M307 360L746.84 395.302C758.791 396.261 768 406.239 768 418.228V608M307 360H284.468C267.804 360 256.671 377.168 263.469 392.383L312 501M370 608H390M370 608L341 554.5M473 608V375M473 608H390M473 608H541M473 375L390 367.5M473 375L541 382M609 389V585C609 597.703 598.703 608 586 608H541M609 389L541 382M609 389L666.5 393M390 367.5V608M541 382V608M666.5 393L702.596 395.511C714.65 396.35 724 406.372 724 418.456V585C724 597.703 713.703 608 701 608H689.5C676.797 608 666.5 597.703 666.5 585V393ZM312 501L301.14 476.238C294.474 461.04 305.607 444 322.203 444H819M312 501H819M312 501L341 554.5M341 554.5H819" stroke="black" stroke-width="9"/>
      </g>
      </svg>
      <h3 :class="{basketPulsing : this.basketPulse}" v-if="basketItems < 9" id="priceDisplay">{{ basketItems }}</h3>
      <h3 :class="{basketPulsing : this.basketPulse}" v-if="basketItems > 9" id="priceDisplay">9+</h3>
    </router-link> -->
  </div>
  <transition name="bounce">
    <div v-if="isMobileNavOpen" id="mobileNav">
      <div class="buttonContainer">
        <router-link v-on:click="isMobileNavOpen = !isMobileNavOpen" class="mNavButtons" aria-label="Home" to="/">Home</router-link>
        <router-link v-on:click="isMobileNavOpen = !isMobileNavOpen" class="mNavButtons" aria-label="Menu" to="/menu">Menu</router-link>
        <router-link v-if="basketItems < 9" v-on:click="isMobileNavOpen = !isMobileNavOpen" class="mNavButtons containsBasket" aria-label="Menu" to="/basket">Basket<span class="basketItem">{{ basketItems }}</span></router-link>
        <router-link v-if="basketItems > 9" v-on:click="isMobileNavOpen = !isMobileNavOpen" class="mNavButtons containsBasket" aria-label="Menu" to="/basket">Basket<span class="basketItem">9+</span></router-link>
      </div>
    </div>
  </transition> 
  <transition name="bounce">
      <div v-if="buyAlert" id="buyAlertContainer">
        <div class="innerContainer">
          <h2>Item added to Basket</h2>
          <br>
          <div class="progressBar">
            <span :class="{ barActive : buyAlert}"></span>
          </div>
          <br style="margin-bottom: 10px">   
          <router-link @click="buyAlert = false" to="/basket">View Basket</router-link>    
        </div>
      </div>
  </transition>
  <!-- </teleport> -->
   <span class="navigation-bar-relative-spacing"></span>
  <router-view/>
</template>

<script>
import { onMounted } from '@vue/runtime-core'
export default{
  data(){
    return{
      isMobileNavOpen: false,
      basketItems: 0,
      basketPulse: false,
      buyAlert: false,
      basketOccupied: false,
      processingAlert: false,
      darkMode: false,
    }
  },
  methods:{
    handleMobile(){
      this.isMobileNavOpen = !this.isMobileNavOpen
    },
    getBasket(params){
      var self = this;
      let prevBasket = self.basketItems
      self.basketItems = 0;
      // console.log("Basket Running");
      Object.keys(sessionStorage).forEach(function(key){
        // console.log(key);
        if(key.includes("itemId-")){
          self.basketItems += parseInt(sessionStorage.getItem(key))
          // console.log(self.basketItems)
        }
      });
      if(params === true){
        prevBasket = self.basketItems;
      }
      if(self.basketItems > prevBasket){
        self.basketPulse = true;
        self.prevBasket = self.basketItems;
      }
      if(self.basketItems > 0){
        self.basketOccupied = true;
      }else{
        self.basketOccupied = false;
      };
      setTimeout(() =>{
        self.basketPulse = false;
      },6000)
    },
    itemBoughtAlert(){
      var self  = this;
      if(self.processingAlert === false){
        self.buyAlert = true;  
        self.processingAlert = true;
        setTimeout(() => {
          self.buyAlert = false;
          self.processingAlert = false;
        },6000)
      }
    },
    componentGrabBasketItems(){
      var self = this;
      var arrayToPush = [];
      // console.log("Basket (Component) Running");
      Object.keys(sessionStorage).forEach(function(key){
        // console.log(key);
        if(key.includes("itemId-")){
          var quantity = sessionStorage.getItem(key)
          arrayToPush.push({itemKey: key, itemQuantity: parseInt(quantity)})
        }
      });
      console.log(arrayToPush)
      return arrayToPush;
    },
    basketItemsPing(){
      var self = this;
      return self.basketItems;
    },
    getDarkMode(){
      if(localStorage.getItem('mode')){
        this.darkMode = localStorage.getItem('mode');
        document.body.classList.add(this.darkMode);
      }else{
        localStorage.setItem('mode', 'dark');
        this.darkMode = localStorage.getItem('mode');
        document.body.classList.add(this.darkMode);
      }
    },
  },
  mounted(){
    var self = this;
    self.getBasket(true);
    self.getDarkMode();
  },
}
</script>

<style>
@import './assets/styles/global.css';
</style>

<style scoped src="./assets/styles/app.css">
</style>
